# WordPress Malware Scanner Plugin

**WARNING: USE AT YOUR OWN RISK! This plugin is a work in progress and may not function as intended. It could potentially disrupt your site or scripts.**

## Description
This plugin scans and attempts to clean your WordPress installation for common types of malware. It uses the `finfo_open()` and `finfo_file()` functions to check the MIME type of each file, as well as the `pathinfo()` function and a list of file extensions to identify files that are likely to contain malware. The plugin searches the contents of each file for common strings that are often used in web malware and attempts to scrub them out by replacing them with an empty string. If a file cannot be cleaned, it is added to a list of infected files for you to review.

## Features
- Scans WordPress files for common malware strings and base64-encoded malware.
- Attempts to clean infected files by removing malicious code.
- Provides an admin interface with buttons to run the scan and perform a dry run.
- Logs the results of the scan and cleaning process.

## Installation
1. Download the plugin and upload it to your WordPress `/wp-content/plugins/` directory.
2. Activate the plugin through the 'Plugins' menu in WordPress.

## Usage
1. Navigate to the 'Malware Scanner' page in the WordPress admin dashboard.
2. Click 'Run Scan' to scan and attempt to clean your WordPress installation.
3. Click 'Dry Run' to perform a scan without modifying any files, listing potentially infected files.

## Important Notes
- The plugin will attempt to clean any infected files that it finds, but it may not be able to completely remove all instances of malware.
- Always make backups of your files before running any scripts that modify them.
- This script is not designed to delete all PHP code from a file. It only looks for specific strings that are commonly used in web malware and attempts to remove them.
- This script is a simple example and may not be sufficient for thoroughly cleaning a WordPress installation from all types of malware. Use a reputable antivirus or security plugin to scan and clean your WordPress installation, and keep your WordPress core, themes, and plugins up to date to protect against known vulnerabilities.

## Example
